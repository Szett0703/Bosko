<!-- Profile Page - CSS Puro -->
<div class="profile-page">
  <div class="profile-container">

    <!-- Page Header with User Avatar Card -->
    <div class="profile-header">
      <div class="header-banner"></div>
      <div class="header-content">
        <div class="header-main">
          <!-- Avatar Section -->
          <div class="avatar-section">
            <div class="avatar-container">
              <div class="avatar-circle">
                @if (currentUser && currentUser.avatarUrl) {
                  <img [src]="currentUser.avatarUrl" alt="Avatar" class="avatar-image">
                } @else {
                  <span>{{ getUserInitials(currentUser?.name || 'U') }}</span>
                }
              </div>
              <button (click)="triggerAvatarUpload()" class="avatar-upload-btn">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/>
                </svg>
              </button>
              <input #avatarInput type="file" accept="image/*" (change)="onAvatarSelected($event)" class="avatar-input">
            </div>

            <div class="user-info">
              <h1 class="user-name">{{ currentUser?.name || 'Usuario' }}</h1>
              <p class="user-email">{{ currentUser?.email }}</p>
              <div class="user-badges">
                <span class="badge badge-role">
                  <svg fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                  </svg>
                  {{ currentUser?.role || 'Customer' }}
                </span>
                @if (currentUser?.isActive) {
                  <span class="badge badge-active">
                    <span class="status-dot"></span>
                    Activo
                  </span>
                }
              </div>
            </div>
          </div>

          <!-- Stats Cards -->
          <div class="stats-grid">
            <div class="stat-card stat-orders">
              <p class="stat-value">{{ orders.length }}</p>
              <p class="stat-label">Pedidos</p>
            </div>
            <div class="stat-card stat-addresses">
              <p class="stat-value">{{ addresses.length }}</p>
              <p class="stat-label">Direcciones</p>
            </div>
            @if (currentUser?.totalSpent !== undefined && currentUser?.totalSpent !== null) {
              <div class="stat-card stat-spent">
                <p class="stat-value">${{ currentUser?.totalSpent || 0 }}</p>
                <p class="stat-label">Gastado</p>
              </div>
            }
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content with Tabs -->
    <div class="main-layout">

      <!-- Sidebar Navigation -->
      <aside class="sidebar-nav">
        <nav class="nav-tabs">
          @for (tab of tabs; track tab.id) {
            <button (click)="switchTab(tab.id)" [class.active]="activeTab() === tab.id" class="nav-tab">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" [attr.d]="tab.icon"/>
              </svg>
              <span>{{ tab.label }}</span>
            </button>
          }
        </nav>
      </aside>

      <!-- Content Area -->
      <main>

        <!-- Personal Information Tab -->
        @if (activeTab() === 'personal') {
          <div class="content-card">
            <div class="content-header">
              <h2 class="content-title">Información Personal</h2>
              @if (saveSuccess()) {
                <div class="success-message">
                  <svg fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                  </svg>
                  <span>¡Guardado con éxito!</span>
                </div>
              }
            </div>

            <form [formGroup]="profileForm" (ngSubmit)="onSaveProfile()" class="profile-form">
              
              <!-- Name Field -->
              <div class="form-group">
                <label class="form-label">
                  Nombre Completo <span class="required">*</span>
                </label>
                <div class="input-wrapper">
                  <div class="input-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                    </svg>
                  </div>
                  <input
                    type="text"
                    formControlName="name"
                    placeholder="Juan Pérez"
                    class="form-input"
                    [class.error]="profileForm.get('name')?.invalid && profileForm.get('name')?.touched">
                </div>
                @if (profileForm.get('name')?.invalid && profileForm.get('name')?.touched) {
                  <p class="error-message">El nombre es requerido (mínimo 2 caracteres)</p>
                }
              </div>

              <!-- Email Field -->
              <div class="form-group">
                <label class="form-label">
                  Correo Electrónico <span class="required">*</span>
                </label>
                <div class="input-wrapper">
                  <div class="input-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                    </svg>
                  </div>
                  <input
                    type="email"
                    formControlName="email"
                    placeholder="juan@ejemplo.com"
                    class="form-input"
                    [class.error]="profileForm.get('email')?.invalid && profileForm.get('email')?.touched">
                </div>
                @if (profileForm.get('email')?.invalid && profileForm.get('email')?.touched) {
                  <p class="error-message">Ingresa un correo válido</p>
                }
              </div>

              <!-- Phone Field -->
              <div class="form-group">
                <label class="form-label">Teléfono</label>
                <div class="input-wrapper">
                  <div class="input-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                    </svg>
                  </div>
                  <input
                    type="tel"
                    formControlName="phone"
                    placeholder="+52 123 456 7890"
                    class="form-input">
                </div>
              </div>

              <!-- Account Info (Read-only) -->
              <div class="account-info-section">
                <h3 class="section-subtitle">Información de Cuenta</h3>
                <div class="info-grid">
                  <div class="info-box">
                    <p class="info-box-label">ID de Usuario</p>
                    <p class="info-box-value">#{{ currentUser?.id }}</p>
                  </div>
                  <div class="info-box">
                    <p class="info-box-label">Rol</p>
                    <p class="info-box-value">{{ currentUser?.role }}</p>
                  </div>
                  <div class="info-box">
                    <p class="info-box-label">Miembro Desde</p>
                    <p class="info-box-value">{{ currentUser?.createdAt | date: 'dd/MM/yyyy' }}</p>
                  </div>
                  <div class="info-box">
                    <p class="info-box-label">Estado</p>
                    <p class="info-box-value" [class.active]="currentUser?.isActive" [class.inactive]="!currentUser?.isActive">
                      {{ currentUser?.isActive ? 'Activo' : 'Inactivo' }}
                    </p>
                  </div>
                </div>
              </div>

              @if (saveError()) {
                <div class="error-alert">
                  <p>{{ saveError() }}</p>
                </div>
              }

              <!-- Submit Button -->
              <div class="form-actions">
                <button type="button" (click)="profileForm.reset()" class="btn btn-cancel">
                  Cancelar
                </button>
                <button type="submit" [disabled]="profileForm.invalid || isLoadingProfile()" class="btn btn-primary">
                  @if (isLoadingProfile()) {
                    <svg class="spinner" fill="none" viewBox="0 0 24 24">
                      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span>Guardando...</span>
                  } @else {
                    <span>Guardar Cambios</span>
                  }
                </button>
              </div>
            </form>
          </div>
        }

        <!-- Security Tab -->
        @if (activeTab() === 'security') {
          <div class="content-card">
            <div class="content-header">
              <h2 class="content-title">Seguridad</h2>
              @if (passwordSuccess()) {
                <div class="success-message">
                  <svg fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                  </svg>
                  <span>¡Contraseña actualizada!</span>
                </div>
              }
            </div>

            <form [formGroup]="passwordForm" (ngSubmit)="onChangePassword()" class="profile-form">
              
              <!-- Current Password -->
              <div class="form-group">
                <label class="form-label">
                  Contraseña Actual <span class="required">*</span>
                </label>
                <div class="input-wrapper">
                  <div class="input-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                    </svg>
                  </div>
                  <input
                    type="password"
                    formControlName="currentPassword"
                    placeholder="••••••••"
                    class="form-input"
                    [class.error]="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched">
                </div>
                @if (passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched) {
                  <p class="error-message">La contraseña actual es requerida</p>
                }
              </div>

              <!-- New Password -->
              <div class="form-group">
                <label class="form-label">
                  Nueva Contraseña <span class="required">*</span>
                </label>
                <div class="input-wrapper">
                  <div class="input-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/>
                    </svg>
                  </div>
                  <input
                    type="password"
                    formControlName="newPassword"
                    placeholder="••••••••"
                    class="form-input"
                    [class.error]="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched">
                </div>
                @if (passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched) {
                  <p class="error-message">La contraseña debe tener al menos 6 caracteres</p>
                }
              </div>

              <!-- Confirm Password -->
              <div class="form-group">
                <label class="form-label">
                  Confirmar Nueva Contraseña <span class="required">*</span>
                </label>
                <div class="input-wrapper">
                  <div class="input-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                  </div>
                  <input
                    type="password"
                    formControlName="confirmPassword"
                    placeholder="••••••••"
                    class="form-input"
                    [class.error]="passwordForm.hasError('passwordMismatch') && passwordForm.get('confirmPassword')?.touched">
                </div>
                @if (passwordForm.hasError('passwordMismatch') && passwordForm.get('confirmPassword')?.touched) {
                  <p class="error-message">Las contraseñas no coinciden</p>
                }
              </div>

              @if (passwordError()) {
                <div class="error-alert">
                  <p>{{ passwordError() }}</p>
                </div>
              }

              <!-- Submit Button -->
              <div class="form-actions">
                <button type="button" (click)="passwordForm.reset()" class="btn btn-cancel">
                  Cancelar
                </button>
                <button type="submit" [disabled]="passwordForm.invalid || isSavingPassword()" class="btn btn-primary">
                  @if (isSavingPassword()) {
                    <svg class="spinner" fill="none" viewBox="0 0 24 24">
                      <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                      <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span>Guardando...</span>
                  } @else {
                    <span>Cambiar Contraseña</span>
                  }
                </button>
              </div>
            </form>
          </div>
        }

        <!-- Orders Tab -->
        @if (activeTab() === 'orders') {
          <div class="content-card">
            <h2 class="content-title">Mis Pedidos</h2>

            @if (isLoadingOrders()) {
              <div class="loading-container">
                <svg class="loading-spinner" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
              </div>
            } @else if (ordersError) {
              <div class="error-alert">
                <p>{{ ordersError }}</p>
              </div>
            } @else if (orders.length === 0) {
              <div class="empty-state">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
                </svg>
                <h3>No tienes pedidos aún</h3>
                <p>Cuando realices tu primer pedido, aparecerá aquí.</p>
                <a routerLink="/collections" class="btn btn-primary">
                  Explorar Productos
                </a>
              </div>
            } @else {
              <div class="orders-list">
                @for (order of orders; track order.id) {
                  <div class="order-card">
                    <div class="order-card-content">
                      <div class="order-info">
                        <div class="order-header">
                          <h3 class="order-id">Pedido #{{ order.id }}</h3>
                          <span [class]="getStatusClass(order.status)" class="status-badge">
                            {{ getStatusLabel(order.status) }}
                          </span>
                        </div>
                        <p class="order-details">Fecha: {{ order.createdAt | date: 'dd/MM/yyyy HH:mm' }}</p>
                        <p class="order-details">Artículos: {{ order.items.length || 0 }}</p>
                      </div>
                      <div class="order-footer">
                        <div class="order-total-box">
                          <p class="order-total">${{ order.total }}</p>
                          <p class="order-payment">{{ order.paymentMethod }}</p>
                        </div>
                        <button (click)="viewOrderDetails(order)" class="btn-view">
                          Ver Detalles
                        </button>
                      </div>
                    </div>
                  </div>
                }
              </div>
            }
          </div>
        }

        <!-- Addresses Tab -->
        @if (activeTab() === 'addresses') {
          <div class="content-card">
            <div class="content-header">
              <h2 class="content-title">Mis Direcciones</h2>
              <button (click)="openAddressModal()" class="btn btn-primary">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                </svg>
                <span>Nueva Dirección</span>
              </button>
            </div>

            @if (isLoadingAddresses()) {
              <div class="loading-container">
                <svg class="loading-spinner" fill="none" viewBox="0 0 24 24">
                  <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                  <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
              </div>
            } @else if (addressesError) {
              <div class="error-alert">
                <p>{{ addressesError }}</p>
              </div>
            } @else if (addresses.length === 0) {
              <div class="empty-state">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                </svg>
                <h3>No tienes direcciones guardadas</h3>
                <p>Agrega una dirección para facilitar tus compras.</p>
              </div>
            } @else {
              <div class="addresses-grid">
                @for (address of addresses; track address.id) {
                  <div class="address-card" [class.default]="address.isDefault">
                    
                    @if (address.isDefault) {
                      <div class="default-badge">Predeterminada</div>
                    }

                    <div class="address-info">
                      <h3>{{ address.label }}</h3>
                      <div class="address-details">
                        <p>{{ address.street }}</p>
                        <p>{{ address.city }}, {{ address.state }}</p>
                        <p>{{ address.postalCode }}, {{ address.country }}</p>
                      </div>
                    </div>

                    <div class="address-actions">
                      @if (!address.isDefault) {
                        <button (click)="onSetDefaultAddress(address.id)" class="btn-address btn-default">
                          Predeterminada
                        </button>
                      }
                      <button (click)="openAddressModal(address)" class="btn-address btn-edit">
                        Editar
                      </button>
                      <button (click)="onDeleteAddress(address.id)" class="btn-address btn-delete">
                        Eliminar
                      </button>
                    </div>
                  </div>
                }
              </div>
            }
          </div>
        }

        <!-- Preferences Tab -->
        @if (activeTab() === 'preferences') {
          <div class="content-card">
            <h2 class="content-title">Preferencias</h2>

            <form [formGroup]="preferencesForm" (ngSubmit)="onSavePreferences()" class="preferences-list">
              
              <!-- Notifications Toggle -->
              <div class="preference-item">
                <div class="preference-info">
                  <h3>Notificaciones</h3>
                  <p>Recibe actualizaciones sobre tus pedidos</p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" formControlName="notifications">
                  <span class="toggle-slider"></span>
                </label>
              </div>

              <!-- Newsletter Toggle -->
              <div class="preference-item">
                <div class="preference-info">
                  <h3>Newsletter</h3>
                  <p>Recibe ofertas y novedades por email</p>
                </div>
                <label class="toggle-switch">
                  <input type="checkbox" formControlName="newsletter">
                  <span class="toggle-slider"></span>
                </label>
              </div>

              <!-- Language -->
              <div class="language-section">
                <div class="language-content">
                  <div class="language-info">
                    <h3>Idioma</h3>
                    <p>Idioma actual: <span>{{ currentLang() === 'es' ? 'Español' : 'English' }}</span></p>
                  </div>
                  <button type="button" (click)="toggleLanguage()" class="btn-language">
                    Cambiar Idioma
                  </button>
                </div>
              </div>

              <!-- Submit Button -->
              <div class="form-actions">
                <button type="submit" class="btn btn-primary">
                  Guardar Preferencias
                </button>
              </div>
            </form>
          </div>
        }

      </main>
    </div>

  </div>
</div>

<!-- Address Modal -->
@if (showAddressModal()) {
  <div class="modal-overlay">
    <div class="modal-backdrop" (click)="closeAddressModal()"></div>
    <div class="modal-container">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">
            {{ editingAddress ? 'Editar Dirección' : 'Nueva Dirección' }}
          </h3>
          <button (click)="closeAddressModal()" class="modal-close">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>

        <div class="modal-body">
          <form [formGroup]="addressForm" (ngSubmit)="onSaveAddress()" class="profile-form">
            
            <div class="address-form-grid">
              <!-- Full Name -->
              <div class="form-group full-width">
                <label class="form-label">Nombre Completo</label>
                <input type="text" formControlName="fullName" placeholder="Juan Pérez" class="form-input">
              </div>

              <!-- Street -->
              <div class="form-group full-width">
                <label class="form-label">Calle y Número</label>
                <input type="text" formControlName="street" placeholder="Av. Insurgentes Sur 1234" class="form-input">
              </div>

              <!-- City -->
              <div class="form-group">
                <label class="form-label">Ciudad</label>
                <input type="text" formControlName="city" placeholder="Ciudad de México" class="form-input">
              </div>

              <!-- State -->
              <div class="form-group">
                <label class="form-label">Estado</label>
                <input type="text" formControlName="state" placeholder="CDMX" class="form-input">
              </div>

              <!-- Postal Code -->
              <div class="form-group">
                <label class="form-label">Código Postal</label>
                <input type="text" formControlName="postalCode" placeholder="01234" class="form-input">
              </div>

              <!-- Country -->
              <div class="form-group">
                <label class="form-label">País</label>
                <input type="text" formControlName="country" placeholder="México" class="form-input">
              </div>

              <!-- Phone -->
              <div class="form-group full-width">
                <label class="form-label">Teléfono</label>
                <input type="tel" formControlName="phone" placeholder="+52 123 456 7890" class="form-input">
              </div>

              <!-- Is Default -->
              <div class="form-group full-width">
                <label class="checkbox-wrapper">
                  <input type="checkbox" formControlName="isDefault" class="checkbox-input">
                  <span class="checkbox-label">Establecer como dirección predeterminada</span>
                </label>
              </div>
            </div>

            <div class="form-actions">
              <button type="button" (click)="closeAddressModal()" class="btn btn-cancel">
                Cancelar
              </button>
              <button type="submit" [disabled]="addressForm.invalid" class="btn btn-primary">
                {{ editingAddress ? 'Actualizar' : 'Guardar' }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
}

<!-- Order Details Modal -->
@if (showOrderDetailsModal() && selectedOrder) {
  <div class="modal-overlay">
    <div class="modal-backdrop" (click)="closeOrderDetailsModal()"></div>
    <div class="modal-container">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">Detalles del Pedido #{{ selectedOrder.id }}</h3>
          <button (click)="closeOrderDetailsModal()" class="modal-close">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>

        <div class="modal-body">
          <!-- Order Info -->
          <div class="order-details-grid">
            <div class="detail-box">
              <p class="detail-label">Estado</p>
              <span [class]="getStatusClass(selectedOrder.status)" class="status-badge">
                {{ getStatusLabel(selectedOrder.status) }}
              </span>
            </div>
            <div class="detail-box">
              <p class="detail-label">Fecha</p>
              <p class="detail-value">{{ selectedOrder.createdAt | date: 'dd/MM/yyyy' }}</p>
            </div>
            <div class="detail-box">
              <p class="detail-label">Pago</p>
              <p class="detail-value">{{ selectedOrder.paymentMethod }}</p>
            </div>
            <div class="detail-box">
              <p class="detail-label">Total</p>
              <p class="detail-value total">${{ selectedOrder.total }}</p>
            </div>
          </div>

          <!-- Items -->
          <div class="order-items-section">
            <h4>Artículos</h4>
            <div class="order-items-list">
              @for (item of selectedOrder.items; track item.id) {
                <div class="order-item">
                  <div class="item-image"></div>
                  <div class="item-info">
                    <p class="item-name">{{ item.productName }}</p>
                    <p class="item-quantity">Cantidad: {{ item.quantity }} x ${{ item.unitPrice }}</p>
                  </div>
                  <p class="item-price">${{ item.subtotal }}</p>
                </div>
              }
            </div>
          </div>

          <!-- Shipping Address -->
          @if (selectedOrder.shippingAddress) {
            <div class="shipping-section">
              <h4>Dirección de Envío</h4>
              <div class="shipping-box">
                <p>{{ getFormattedAddress(selectedOrder.shippingAddress) }}</p>
              </div>
            </div>
          }

          <div class="modal-footer">
            <button (click)="closeOrderDetailsModal()" class="btn-close-modal">
              Cerrar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
}
