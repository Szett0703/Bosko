<div class="profile-container">
  <h1 class="page-title">{{ t().profile.pageTitle }}</h1>

  <div class="profile-content">
    <!-- Personal Information -->
    <section class="profile-section">
      <h2 class="section-title">{{ t().profile.personalInfo.title }}</h2>

      <form [formGroup]="profileForm" (ngSubmit)="onSaveProfile()" class="profile-form">
        <div *ngIf="saveSuccess()" class="success-message">
          ✓ {{ currentLang() === 'es' ? 'Cambios guardados exitosamente' : 'Changes saved successfully' }}
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">{{ t().profile.personalInfo.name }}</label>
            <input type="text" formControlName="name" class="form-input">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">{{ t().profile.personalInfo.email }}</label>
            <input type="email" formControlName="email" class="form-input">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">{{ t().profile.personalInfo.phone }}</label>
            <input type="tel" formControlName="phone" class="form-input">
          </div>
        </div>

        <button type="submit" class="btn-save" [disabled]="profileForm.invalid">
          {{ t().profile.personalInfo.save }}
        </button>
      </form>
    </section>

    <!-- Order History -->
    <section class="profile-section">
      <h2 class="section-title">{{ t().profile.orderHistory.title }}</h2>

      <!-- Loading State -->
      <div *ngIf="isLoadingOrders" class="flex justify-center items-center py-8">
        <div class="animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600"></div>
        <p class="ml-3 text-gray-600">Cargando pedidos...</p>
      </div>

      <!-- Error State -->
      <div *ngIf="ordersError && !isLoadingOrders" class="bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded-lg">
        {{ ordersError }}
      </div>

      <!-- Orders List -->
      <div *ngIf="!isLoadingOrders && !ordersError && orders.length > 0" class="orders-list">
        <div class="overflow-x-auto">
          <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  {{ currentLang() === 'es' ? 'Pedido' : 'Order' }}
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  {{ currentLang() === 'es' ? 'Fecha' : 'Date' }}
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  {{ currentLang() === 'es' ? 'Total' : 'Total' }}
                </th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  {{ currentLang() === 'es' ? 'Estado' : 'Status' }}
                </th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
              <tr *ngFor="let order of orders" class="hover:bg-gray-50">
                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                  #{{ order.id }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                  {{ order.date | date:'short' }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                  ${{ order.total | number:'1.2-2' }}
                </td>
                <td class="px-6 py-4 whitespace-nowrap">
                  <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full"
                        [ngClass]="{
                          'bg-green-100 text-green-800': order.status === 'Completado' || order.status === 'Completed',
                          'bg-yellow-100 text-yellow-800': order.status === 'Pendiente' || order.status === 'Pending',
                          'bg-blue-100 text-blue-800': order.status === 'En proceso' || order.status === 'Processing'
                        }">
                    {{ order.status }}
                  </span>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Empty State -->
      <div *ngIf="!isLoadingOrders && !ordersError && orders.length === 0" class="empty-state">
        <svg width="80" height="80" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
        </svg>
        <p class="empty-message">{{ t().profile.orderHistory.noOrders }}</p>
      </div>
    </section>

    <!-- Preferences -->
    <section class="profile-section">
      <h2 class="section-title">{{ t().profile.preferences.title }}</h2>

      <div class="preferences-list">
        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-label">{{ t().profile.preferences.language }}</h3>
            <p class="preference-desc">{{ currentLang() === 'es' ? 'Español' : 'English' }}</p>
          </div>
          <button class="btn-change" (click)="toggleLanguage()">
            {{ currentLang() === 'es' ? 'Cambiar' : 'Change' }}
          </button>
        </div>

        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-label">{{ t().profile.preferences.notifications }}</h3>
            <p class="preference-desc">{{ currentLang() === 'es' ? 'Recibir notificaciones por correo' : 'Receive email notifications' }}</p>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" formControlName="notifications">
            <span class="slider"></span>
          </label>
        </div>

        <div class="preference-item">
          <div class="preference-info">
            <h3 class="preference-label">{{ t().profile.preferences.newsletter }}</h3>
            <p class="preference-desc">{{ currentLang() === 'es' ? 'Recibir ofertas y novedades' : 'Receive offers and news' }}</p>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" formControlName="newsletter">
            <span class="slider"></span>
          </label>
        </div>
      </div>
    </section>
  </div>
</div>
